{"version":3,"file":"paste.global.js","sources":["../node_modules/tiny-emitter/index.js","../src/index.ts"],"sourcesContent":["function E () {\n  // Keep this empty so it's easier to inherit from\n  // (via https://github.com/lipsmack from https://github.com/scottcorgan/tiny-emitter/issues/3)\n}\n\nE.prototype = {\n  on: function (name, callback, ctx) {\n    var e = this.e || (this.e = {});\n\n    (e[name] || (e[name] = [])).push({\n      fn: callback,\n      ctx: ctx\n    });\n\n    return this;\n  },\n\n  once: function (name, callback, ctx) {\n    var self = this;\n    function listener () {\n      self.off(name, listener);\n      callback.apply(ctx, arguments);\n    };\n\n    listener._ = callback\n    return this.on(name, listener, ctx);\n  },\n\n  emit: function (name) {\n    var data = [].slice.call(arguments, 1);\n    var evtArr = ((this.e || (this.e = {}))[name] || []).slice();\n    var i = 0;\n    var len = evtArr.length;\n\n    for (i; i < len; i++) {\n      evtArr[i].fn.apply(evtArr[i].ctx, data);\n    }\n\n    return this;\n  },\n\n  off: function (name, callback) {\n    var e = this.e || (this.e = {});\n    var evts = e[name];\n    var liveEvents = [];\n\n    if (evts && callback) {\n      for (var i = 0, len = evts.length; i < len; i++) {\n        if (evts[i].fn !== callback && evts[i].fn._ !== callback)\n          liveEvents.push(evts[i]);\n      }\n    }\n\n    // Remove event from queue to prevent memory leak\n    // Suggested by https://github.com/lazd\n    // Ref: https://github.com/scottcorgan/tiny-emitter/commit/c6ebfaa9bc973b33d110a84a307742b7cf94c953#commitcomment-5024910\n\n    (liveEvents.length)\n      ? e[name] = liveEvents\n      : delete e[name];\n\n    return this;\n  }\n};\n\nmodule.exports = E;\nmodule.exports.TinyEmitter = E;\n","import { TinyEmitter } from 'tiny-emitter'\n\nexport type PasteResult = {\n  kind: string\n  data: File | string\n  type: string\n}\nexport type OnPasteEventType = (e: PasteResult) => void\n\nconst PasteEventType = 'paste'\n\nconst emitter = new TinyEmitter()\n\n/**\n * 监听用户的粘贴行为\n */\nexport default function onPaste() {\n  document.addEventListener('paste', e => {\n    e.preventDefault()\n    const items = e.clipboardData?.items\n    if (items) {\n      handle(items)\n    }\n  })\n\n  return {\n    version: __VERSION__,\n    on(fn: OnPasteEventType) {\n      emitter.on(PasteEventType, fn)\n    }\n  }\n}\n\nfunction handle(items: DataTransferItemList) {\n  // 最后一个对象\n  const item = items[items.length - 1]\n  // 对象的类别和类型\n  const { kind, type } = item\n\n  switch(kind) {\n    case 'file':\n      // 文件\n      const file = item.getAsFile()\n      if (file) {\n        emitter.emit(PasteEventType, {\n          kind,\n          type,\n          data: file\n        })\n      }\n      break\n    case 'string':\n      // 字符\n      item.getAsString(str => {\n        emitter.emit(PasteEventType, {\n          kind,\n          type,\n          data: str\n        })\n      })\n      break\n    default:\n      break\n  }\n}\n\n"],"names":[],"mappings":"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"}